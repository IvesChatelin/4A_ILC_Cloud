services:
  frontend:
    container_name: frontend
    image: ives_ilyass_twitter/front
    build:
      context: frontend
      dockerfile_inline: |
        FROM node:20.11.1-alpine3.19
        WORKDIR /frontend
        RUN npm install -g @angular/cli
        COPY package.json package-lock.json ./
        RUN npm ci
        COPY . /frontend
    command: ng serve --host 0.0.0.0
    ports:
      - "4200:4200"

  backend:
    container_name: backend
    image: ives_ilyass_twitter/api
    build: 
      context: backend
      dockerfile_inline: |
        FROM python:3.12.2-alpine3.18
        WORKDIR /backend
        COPY . /backend
        RUN pip install FLASK \
            pip install -U flask_cors \
            pip install pandas \
            pip install redis
    environment:
      - FLASK_APP=api.py
      - FLASK_RUN_HOST=0.0.0.0
      - FLASK_ENV=development
    command: flask run 
    ports:
      - "5000:5000"
    depends_on:
      - redis

  redis:
    container_name: redis
    image: redis
    ports:
      - "6379:6379"